# 实验 7：提交报告：综合实验

实验目的：教学生如何使用 REXX 完成实验环境清理工作
实验结果：实验后，学生应该掌握
REXX 中 TSO 命令的执行
REXX 中 IDCAMS 命令的执行
REXX 中 RACF 命令的执行
在 JCL 中执行 REXX 程序
实验介绍：本实验为必做实验
实验步骤：

## 步骤 1 编写 REXX 程序 CLEAR，实现以下功能

编写 REXX 程序清除你的实验环境
[1] 删除所有用户私有数据集
[2] 其中 ISPF 工作数据集建议不删

_____________________________________________________________________________
提示：用 REXX 删除数集及执行 RACF 命令有多种方法，下面以删除数据集为例介绍 2 种方法，执
行 RACF 命令的方法是类似的。
1） 使用多个 TSO 命令删除 n 个数据集
“DELETE yourid.DS1”; “DELETE yourid.DS2”; … “DELETE yourid.DSn”
此处 yourid.DSk（1

![](/img/rexx/lab3/20.1.png)

2） 使用 JCL 删除数据集，然后通过 REXX 执行 JCL 命令
JCL 可以调用 ADRDSSU 实用程序的 DUMP 方法批量删除数据集。假设 JCL 作业为
yourid.JCL(DELDS)，REXX 执行 JCL 的语句为”SUB yourid.JCL(DELDS)”，难点是需要考虑如
何准确获取作业执行的返回码。

## 步骤 2 编写 REXX 程序 LISTDS，查看以用户名打头的数据集

![](/img/rexx/lab3/20.3.png)

_________________________________________________________

## 步骤 3 编写 REXX 程序 LISTGU，查看 RACF 组和用户以及其他一些 RACF Profile 的信息

![](/img/rexx/lab3/TIM图片20190625155856.png)

## 步骤 4 编写 JCL 作业，实现以下功能

[1] 作业步 1：验证安全管理实验环境已经恢复，执行上述 REXX 程序 LISTGU
[2] 作业步 2，清除用户数据集，执行上述 REXX 程序 CLEAR
[3] 作业步 3，验证用户数据集已经删除，执行上述 REXX 程序 LISTDS

![](/img/rexx/lab3/TIM图片20190625155908.png)

_____________________________________________________________________________________
提示：对以上 3 个作业步给出示例代码如下，假设用户的 REXX 库为 yourid.REXX.LIB。前面用于
显示 REXX 程序内容，后面是执行 REXX 程序。

## 步骤 5 提交实验报告，注意，为了能够删除所有私有数据集（包括用户的 REXX 库，但 ISPF 工作数据集建议不删），建议把上面的 REXX 程序和 JCL 作业存储在管理员提供的公共库中。

1）提交步骤4中的作业，注意作业名必须为youridR5，其中xx为用户ID的后2位数字。确保作业执行
成功，返回码为0。
2） 在SDSF;ST面板中找到该作业，在作业左侧使用XD命令把作业内容输出到数据集
yourid.REXX.REPORT中。
3） 最后通过FTP工具（比如FileZilla）把数据集yourid.REXX.REPORT下载到本地提交到服务器。

